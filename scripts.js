function phpWGOpenWindow(t,e,n){if(img=new Image,img.src=t,img.complete)var o=img.width+40,s=img.height+40;else{o=640,s=480;img.onload=function(){newWin.resizeTo(img.width+50,img.height+100)}}newWin=window.open(t,e,n+",left=2,top=1,width="+o+",height="+s)}function popuphelp(t){window.open(t,"dc_popup","alwaysRaised=yes,dependent=yes,toolbar=no,height=420,width=500,menubar=no,resizable=yes,scrollbars=yes,status=no")}function pwgBind(t,e){var n=Array.prototype.slice.call(arguments,2);return function(){return e.apply(t,n.concat(Array.prototype.slice.call(arguments,0)))}}function PwgWS(t){this.urlRoot=t,this.options={method:"GET",async:!0,onFailure:null,onSuccess:null}}function pwgAddEventListener(t,e,n){window.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)}PwgWS.prototype={callService:function(t,e,n){if(n)for(var o in n)this.options[o]=n[o];try{this.xhr=new XMLHttpRequest}catch(t){try{this.xhr=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{this.xhr=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){return void this.error(0,"Cannot create request object")}}}this.xhr.onreadystatechange=pwgBind(this,this.onStateChange);var s=this.urlRoot+"ws.php?format=json&method="+t,i="";if(e)for(var o in e)if("object"==typeof e[o]&&e[o])for(var r=0;r<e[o].length;r++)i+=o+"[]="+encodeURIComponent(e[o][r])+"&";else i+=o+"="+encodeURIComponent(e[o])+"&";"POST"!=this.options.method&&(s+="&"+i,i=null),this.xhr.open(this.options.method,s,this.options.async),"POST"==this.options.method&&this.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");try{this.xhr.send(i)}catch(t){this.error(0,t.message)}},onStateChange:function(){var t=this.xhr.readyState;if(4==t)try{this.respondToReadyState(t)}finally{this.cleanup()}},error:function(t,e){!this.options.onFailure||this.options.onFailure(t,e),this.cleanup()},respondToReadyState:function(t){var e=this.xhr;if(4==t&&200==e.status){var n;try{n=window.JSON&&window.JSON.parse?window.JSON.parse(e.responseText):new Function("return "+e.responseText)()}catch(t){this.error(200,t.message+"\n"+e.responseText.substr(0,512))}null!=n&&(null==n.stat?this.error(200,"Invalid response"):"ok"==n.stat?!this.options.onSuccess||this.options.onSuccess(n.result):this.error(200,n.err+" "+n.message))}4==t&&200!=e.status&&this.error(e.status,e.statusText)},cleanup:function(){this.xhr&&(this.xhr.onreadystatechange=null),this.xhr=null,this.options.onFailure=this.options.onSuccess=null},xhr:null};
